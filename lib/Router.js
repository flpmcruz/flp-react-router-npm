import{jsx as _jsx}from"react/jsx-runtime";import{useEffect,useState,Children}from"react";import{match}from"path-to-regexp";import{EVENTS}from"./constants";import{getCurrentPath}from"./utils/getCurrentPath";export function Router({children,routes=[],fallback:DefaultComponent=()=>_jsx("h1",{children:"404"})}){const[currentPath,setCurrentPath]=useState(getCurrentPath());useEffect(()=>{const onLocationChange=()=>setCurrentPath(getCurrentPath());window.addEventListener(EVENTS.PUSHSTATE,onLocationChange);window.addEventListener(EVENTS.POPSTATE,onLocationChange);return()=>{window.removeEventListener(EVENTS.PUSHSTATE,onLocationChange);window.removeEventListener(EVENTS.POPSTATE,onLocationChange)}},[]);const childrenRoutes=Children.map(children,({props,type})=>{const{name}=type;return name==="Route"?props:null});const routeToUse=routes.concat(childrenRoutes).filter(Boolean);let routeParams={};const Page=routeToUse.find(({path})=>{if(path===currentPath)return true;const matcherUrl=match(path,{decode:decodeURIComponent});const matchUrl=matcherUrl(currentPath);if(!matchUrl)return false;routeParams=matchUrl.params;return true})?.component;return Page?_jsx(Page,{routeParams:routeParams}):DefaultComponent()}